<nz-table nzBordered #userTable [nzData]="showSuborders">
  <thead>
    <tr>
      <th>N</th>
      <th>Номер заказа</th>
      <th>Общая сумма</th>
      <th>Дата начала</th>
      <th>Гарантия</th>
      <th>Статус</th>
      <th>Исполнитель</th>

      <th>Статус оплаты</th>
      <th>Способ оплаты</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <!-- payed: false
payed_by_cache: true  achq-->
    <tr *ngFor="let data of userTable.data; let ind = index">
      <td style="width:10px">{{ ind + 1 }}</td>
      <td>{{data.name}}</td>
      <td>{{data.suborderMain.price}}</td>
      <td>{{data.suborderMain.start_date | date:'yyyy-MM-dd'}}</td>
      <td>{{data?.suborderMain?.guarantee_period}}</td>
      <td>{{data?.status}}</td>
      <td>
        {{checkExecutor(data.executors)}}
      </td>

      <td style="width: 20px">
        <nz-switch [nzDisabled]="data?.suborderMain.payed" *ngIf="data?.status == 'Выполнено'"
          [(ngModel)]="data?.suborderMain.payed" (ngModelChange)="changeStatus(data)"></nz-switch>
      </td>
      <td>
        <div
          *ngIf="(data?.suborderMain?.payed && !data?.suborderMain?.payed_by_cache) || (!data?.suborderMain?.payed && data?.suborderMain?.payed_by_cache) || (data?.suborderMain?.payed && data?.suborderMain?.payed_by_cache)">
          <div>{{data.suborderMain.payed_by_cache ? 'Наличными' :'Картой'}}</div>
        </div>
      </td>
      <td class="action-button edit" style="width: 100px">
        <i (click)="openPaymentControlModal(data)" *ngIf="!data.suborderMain.payed && data.suborderMain.payed_by_cache"
          nz-icon nzType="eye"></i>
      </td>
      <td (click)="onEditSuborder(data)" class="action-button edit" style="width: 10px">
        <i nz-icon nzType="edit"></i>
      </td>
      <td class="action-button delete" style="width: 10px">
        <a nz-popconfirm nzPopconfirmTitle="Вы уверены?" nzPopconfirmPlacement="bottom"
          (nzOnConfirm)="deleteSuborder(data.suborderMain.id)">
          <i *ngIf="!data.suborderMain.payed && data.disput?.length === 0" nz-icon nzType="delete"></i>
        </a>
      </td>
    </tr>
  </tbody>
</nz-table>

<nz-modal [(nzVisible)]="isPaymentControlPanelVisible" nzTitle="Подробно о оплате"
  (nzOnCancel)="closePaymentControlModal()" (nzOnOk)="changeDebetStatus()">
  <app-orders-payment-control-panel [defaultDebet]="sub?.suborderMain.debet"
    (onDebitChanged)="handleDebitChange($event)"></app-orders-payment-control-panel>
</nz-modal>