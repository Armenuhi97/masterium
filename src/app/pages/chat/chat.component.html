<div class="container m-0">

  <div class="row rounded-lg overflow-hidden shadow">

    <div class="col-5 px-0">
      <div class="bg-grey h-100">
        <div class="bg-gray px-4 py-2 bg-light">
          <p class="h5 mb-0 py-1">Recent</p>
        </div>
        <div [ngStyle]="{'height':windowHeight+'px'}" class="messages-box">
          <div class="list-group rounded-0">
            <ng-container *ngFor="let room of roomsList">
              <app-member-item (selectRoom)="setActiveRoom($event)" [room]="room"
                [active]="activeRoom?.room.id === room.room.id">
              </app-member-item>
            </ng-container>
          </div>
        </div>
      </div>
    </div>
    <div class="col-7 px-0">
      <!--  [scrollTop]="scrollMe.scrollHeight" -->
      <div #scrollMe id="scrollMe" [scrollTop]="scrollToTop(scrollMe.scrollHeight)" infiniteScroll
        [infiniteScrollDistance]="2" [infiniteScrollThrottle]="10" (scrolledUp)="onScrollUp()" [scrollWindow]="false"
        [fromRoot]="false" [ngStyle]="{'height':windowHeight+'px'}" style="overflow:auto" class="px-4 py-5 chat-box bg-white">
        <ng-container *ngFor="let message of messages">
          <app-message-item [message]="message" [isIncoming]="message.replier_is_admin"></app-message-item>
        </ng-container>
      </div>
      <!-- Typing area -->
      <div class="form-control bg-light">
        <div class="d-flex action-button align-items-center justify-content-between" *ngIf="fileControl.value">
          <span>{{fileControl.value?.name}}</span> <i class="trash" (click)="deleteFile()" nz-icon nzType="delete"></i>
        </div>

        <div class="mesage-item align-items-start d-flex justify-content-between">

          <div class="d-flex align-items-center">
            <!-- <nz-upload class="upload" [nzShowUploadList]="false" (nzChange)="handleChange($event)"
              [nzHeaders]="{ authorization: 'authorization-text' }">
              <div class="d-flex align-items-center">
                <button nz-button><i nz-icon nzType="upload"></i></button>
              </div>
            </nz-upload> -->
            <nz-upload class="upload" [nzShowUploadList]="false" (nzChange)="handleChange($event)"
              [nzHeaders]="{ authorization: 'authorization-text' }">
              <div class="d-flex align-items-center">
                <button nz-button>

                  <i *ngIf="fileControl.value" class="success-icon" nz-icon nzType="upload"></i>
                  <i *ngIf="!fileControl.value" nz-icon nzType="upload"></i>
                </button>

              </div>
            </nz-upload>
          </div>
          <div class="w-100">
            <textarea rows="3" [formControl]="messageControl" type="text" placeholder="Введите сообщение"
              class="form-control rounded-0 border-0 w-100 py-0 bg-light">
          </textarea>
          </div>
          <div class="d-flex">
            <button (click)="sendMessage()" type="submit" class="btn"
              [disabled]="messageControl.invalid && fileControl.invalid"> <i nz-icon nzType="send"
                nzTheme="outline"></i></button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>